# PyTorch LSTMè®¿å®¢é¢„æµ‹æ¨¡å‹è®­ç»ƒæ“ä½œæŒ‡å—

## ğŸ“‹ å‡†å¤‡å·¥ä½œ

### ç¯å¢ƒé…ç½®
1. ç¡®ä¿å·²å®‰è£…Python 3.7+
2. å®‰è£…é¡¹ç›®ä¾èµ–ï¼š
   ```bash
   pip install -r requirements.txt
   ```

### æ•°æ®é›†ç»“æ„
é¡¹ç›®é¢„æœŸçš„æ•°æ®é›†ç»“æ„å¦‚ä¸‹ï¼š
```
Dataset/
â”œâ”€â”€ visitor-numbers.csv          # è®¿å®¢æ•°æ®ï¼ˆåŒ…å«å„æ™¯ç‚¹çº¿è·¯è®¿å®¢æ•°ï¼‰
â”œâ”€â”€ order_numbers.csv            # è®¢å•æ•°æ®ï¼ˆåŒ…å«å„æ™¯ç‚¹çº¿è·¯è®¢å•æ•°ï¼‰
â”œâ”€â”€ japan_2024_2025_workdays_binary.csv  # èŠ‚å‡æ—¥æ•°æ®
â”œâ”€â”€ weather_mt_fuji.csv          # å¯Œå£«å±±å¤©æ°”æ•°æ®
â”œâ”€â”€ weather_kyoto_nara.csv       # äº¬éƒ½/å¥ˆè‰¯å¤©æ°”æ•°æ®
â””â”€â”€ weather_sea_of_kyoto.csv     # äº¬éƒ½æµ·æ»¨å¤©æ°”æ•°æ®
```

## â–¶ï¸ è®­ç»ƒæ¨¡å‹

### 1. åŸºæœ¬è®­ç»ƒå‘½ä»¤
```bash
python train.py --mode train
```

### 2. è®­ç»ƒé…ç½®
æ¨¡å‹é…ç½®æ–‡ä»¶ä½äº `configs/model_config.yaml`ï¼ŒåŒ…å«ä»¥ä¸‹ä¸»è¦å‚æ•°ï¼š
- `input_size`: è¾“å…¥ç‰¹å¾ç»´åº¦ï¼ˆå½“å‰ä¸º20ï¼‰
- `hidden_size`: LSTMéšè—å±‚å¤§å°
- `num_layers`: LSTMå±‚æ•°
- `learning_rate`: å­¦ä¹ ç‡
- `batch_size`: æ‰¹æ¬¡å¤§å°
- `num_epochs`: è®­ç»ƒè½®æ•°

### 3. è®­ç»ƒè¿‡ç¨‹
è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šè¾“å‡ºä»¥ä¸‹ä¿¡æ¯ï¼š
- æ¯è½®è®­ç»ƒçš„æŸå¤±å€¼ï¼ˆTrain Loss å’Œ Val Lossï¼‰
- æœ€ä½³æ¨¡å‹ä¿å­˜æç¤º
- è®­ç»ƒå®Œæˆæç¤º

è®­ç»ƒå®Œæˆåä¼šåœ¨ `outputs/` ç›®å½•ä¸‹ç”Ÿæˆä¸¤ä¸ªæ–‡ä»¶ï¼š
- `best_model.pth`: éªŒè¯é›†ä¸Šè¡¨ç°æœ€å¥½çš„æ¨¡å‹
- `final_model.pth`: æœ€ç»ˆè®­ç»ƒå®Œæˆçš„æ¨¡å‹
- `scaler.pkl`: ç‰¹å¾æ ‡å‡†åŒ–å‚æ•°æ–‡ä»¶

## ğŸ”® ä½¿ç”¨æ¨¡å‹è¿›è¡Œé¢„æµ‹

### 1. åŸºæœ¬é¢„æµ‹å‘½ä»¤
```bash
python train.py --mode predict
```

### 2. é¢„æµ‹ç»“æœ
é¢„æµ‹ç»“æœä¼šä¿å­˜åœ¨ `outputs/predictions.csv` æ–‡ä»¶ä¸­ï¼ŒåŒ…å«æœªæ¥7å¤©çš„è®¿å®¢é¢„æµ‹æ•°æ®ã€‚

## ğŸ“ é¡¹ç›®ç›®å½•ç»“æ„

```
.
â”œâ”€â”€ configs/                    # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ model_config.yaml      # æ¨¡å‹é…ç½®æ–‡ä»¶
â”œâ”€â”€ src/                       # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ data/                  # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”‚   â””â”€â”€ dataset.py         # æ•°æ®åŠ è½½å’Œé¢„å¤„ç†
â”‚   â”œâ”€â”€ models/                # æ¨¡å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ lstm.py            # LSTMæ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ predict.py             # é¢„æµ‹è„šæœ¬
â”‚   â””â”€â”€ train.py               # è®­ç»ƒè„šæœ¬
â”œâ”€â”€ Dataset/                   # æ•°æ®é›†ç›®å½•
â”œâ”€â”€ outputs/                   # è¾“å‡ºç›®å½•ï¼ˆæ¨¡å‹å’Œé¢„æµ‹ç»“æœï¼‰
â”œâ”€â”€ requirements.txt           # é¡¹ç›®ä¾èµ–
â””â”€â”€ train.py                  # ä¸»å…¥å£æ–‡ä»¶
```

## âš™ï¸ é…ç½®è¯´æ˜

### æ¨¡å‹é…ç½® (configs/model_config.yaml)
```yaml
model:
  input_size: 20              # è¾“å…¥ç‰¹å¾æ•°ï¼š5è®¿å®¢+5è®¢å•+1å·¥ä½œæ—¥+9å¤©æ°”ç‰¹å¾
  hidden_size: 50             # LSTMéšè—å•å…ƒæ•°
  num_layers: 2               # LSTMå±‚æ•°
  output_size: 1              # è¾“å‡ºç»´åº¦
  dropout: 0.2                # Dropoutæ¯”ç‡

training:
  learning_rate: 0.001        # å­¦ä¹ ç‡
  batch_size: 32              # æ‰¹æ¬¡å¤§å°
  num_epochs: 100             # è®­ç»ƒè½®æ•°
  sequence_length: 7          # åºåˆ—é•¿åº¦ï¼ˆç”¨7å¤©é¢„æµ‹ç¬¬8å¤©ï¼‰

data:
  train_ratio: 0.8            # è®­ç»ƒé›†æ¯”ä¾‹
  val_ratio: 0.1              # éªŒè¯é›†æ¯”ä¾‹
  test_ratio: 0.1             # æµ‹è¯•é›†æ¯”ä¾‹
```

## ğŸ§ª æ•°æ®ç‰¹å¾è¯´æ˜

### è¾“å…¥ç‰¹å¾ï¼ˆå…±20ä¸ªï¼‰
1. **è®¿å®¢æ•°æ®ï¼ˆ5ä¸ªï¼‰**ï¼š
   - mt_fuji-G1, mt_fuji-G2, mt_fuji-D
   - sea_of_kyoto-E
   - kyoto_nara-A

2. **è®¢å•æ•°æ®ï¼ˆ5ä¸ªï¼‰**ï¼š
   - ä¸è®¿å®¢æ•°æ®åˆ—åç›¸åŒ

3. **å·¥ä½œæ—¥æ ‡è¯†ï¼ˆ1ä¸ªï¼‰**ï¼š
   - is_working_dayï¼š0è¡¨ç¤ºéå·¥ä½œæ—¥ï¼Œ1è¡¨ç¤ºå·¥ä½œæ—¥

4. **å¤©æ°”ç‰¹å¾ï¼ˆ9ä¸ªï¼‰**ï¼š
   - å¯Œå£«å±±å¤©æ°”ï¼šmt_fuji_weather_sunny/cloudy/rainy
   - äº¬éƒ½/å¥ˆè‰¯å¤©æ°”ï¼škyoto_nara_weather_sunny/cloudy/rainy
   - äº¬éƒ½æµ·æ»¨å¤©æ°”ï¼šsea_of_kyoto_weather_sunny/cloudy/rainy

## ğŸ“ˆ è®­ç»ƒç›‘æ§

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šæ˜¾ç¤ºæ¯è½®çš„è®­ç»ƒå’ŒéªŒè¯æŸå¤±ï¼š
```
Epoch [1/100], Train Loss: 0.4421, Val Loss: 0.3827
Epoch [2/100], Train Loss: 0.3256, Val Loss: 0.2984
...
```

å½“éªŒè¯æŸå¤±è¿ç»­10è½®æ²¡æœ‰æ”¹å–„æ—¶ä¼šè§¦å‘æ—©åœæœºåˆ¶ï¼Œé˜²æ­¢è¿‡æ‹Ÿåˆã€‚

## ğŸ› ï¸ å¸¸è§é—®é¢˜

### 1. æ•°æ®åŠ è½½é”™è¯¯
ç¡®ä¿æ‰€æœ‰CSVæ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼Œç‰¹åˆ«æ˜¯æ—¥æœŸåˆ—æ ¼å¼ç»Ÿä¸€ä¸º `YYYY/MM/DD`ã€‚

### 2. å†…å­˜ä¸è¶³
å¯ä»¥é€‚å½“å‡å° `batch_size` å‚æ•°ã€‚

### 3. è®­ç»ƒæ•ˆæœä¸ä½³
å¯ä»¥å°è¯•è°ƒæ•´ä»¥ä¸‹è¶…å‚æ•°ï¼š
- å¢åŠ  `hidden_size`
- å¢åŠ  `num_layers`
- è°ƒæ•´ `learning_rate`
- å¢åŠ  `num_epochs`